# VoV ネットワーク設計レビュー資料

本資料は、VoV（Void on Voice）のネットワーク周辺における未確定要素、および今後確定すべき設計指針をまとめたレビュー文書です。

---

## ✅ 確定済み基本方針（抜粋）

- 投稿オブジェクトは Markdown 形式、分割せずに圧縮・暗号化し、キューへ投入（メインプロセス）
- 常駐プロセスが投稿キューを監視し、動的に通信モデルを選定し拡散（ネットワーク専用プロセス）
- ストレージは500MB〜、10GB以上の提供ノードはネットワーク全体に貢献度高く、優先ノードと見なす
- 通信優先順位は「投稿オブジェクト > 添付ファイル（非同期）」

---

## 🔸 未確定／検討中項目一覧

### 1. 再送戦略とTTL管理
- **ACKレスポンスの有無**：再送条件のトリガとしてACKが必要か？
- **TTL切れの再拡散許可**：TTL満了後の投稿をユーザーが明示再拡散できるか？
- **再送間隔と上限制御**：Flood防止と整合性維持のバランスが必要

### 2. ノード信頼性・レピュテーション機構
- **スパム検知とスコア**：匿名性とバランスをとる信用評価機構は導入するか？
- **スコア保存場所**：DHT上かローカルか？暗号署名付きで共有するか？
- **Bot行動の検出手段**：再送異常、TTL無視等の挙動で除外できるか？

### 3. Relayノードの運用ポリシー
- **ノード開放条件**：ユーザー全員か、一定条件を満たすノードのみか？
- **ログの匿名記録**：通信ログの最小限保持と匿名性維持の両立

### 4. DHTパラメータ調整（Kademlia）
- `α`（並列リクエスト数）
- `k`（バケットサイズ）
- ノード老化／削除ポリシーの設計と整合性

### 5. 通知方式（Push vs Pull）
- **Push型**：Gossip/libp2pなど、即時通知可能
- **Pull型**：MQTT/HTTPなど、LowLoadモードでは定期取得が限界
- **混在制御**：接続モードに応じた自動分離運用が必要

### 6. NAT越え自動化（UPnP, NAT-PMP, STUN）
- **OS非依存方式の採用希望**（Go実装）
- **NAT検知結果に応じて複数手法を並列試行し、通過方式を確定する多重プロセス型が理想**
- **失敗時はRelay Meshへフォールバック**

---

## ✅ 次ステップ案

| 優先度 | 項目 | 対応方法案 |
|--------|------|-------------|
| 高 | NAT越え自動化構成 | STUN + UPnP/NAT-PMP並列試行 + 自動フォールバック構造の定義 |
| 中 | ACK戦略・TTL再送 | Gossip由来か、軽量ACK導入の比較検討 |
| 中 | ノードスコア構造 | ローカルスコア + DHT拡張のハイブリッド案の評価 |
| 低 | Relay認定と公開鍵運用 | 信頼ノード制・ユーザー全体制などの運用選択肢提示 |

---

この設計方針のうち、特に「NAT越えと分散構造の多重化」がVoVの核心であり、他の分散P2Pプロジェクトと一線を画す強みとなる。
今後、これらの項目に対する設計確定とPoC実装が進められる予定。
