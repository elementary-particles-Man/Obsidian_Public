# VoV ネットワーク構造：構成コンポーネントドキュメント

本ドキュメントは、VoV（Void on Voice）ネットワーク構造における各コンポーネントの責務・機能を定義します。

---

## 📌 上位レイヤー（ユーザー操作〜通信選択）

### ◼ User UI（UIC）
- **責務**：ユーザーの投稿・返信インターフェースを提供
- **機能**：
  - テキスト入力・音声録音等の投稿機能
  - 環境情報取得のトリガ（起動時・設定変更時）

### ◼ Environment Profiler
- **責務**：クライアントの通信環境を分析し、ネットワークプロファイルを生成
- **機能**：
  - NATタイプ判定（STUNなど）
  - 帯域幅・レイテンシ測定
  - モバイル/デスクトップ判定

### ◼ Comm Model Selector
- **責務**：Profilerから得た情報に基づき、最適な通信モードを選定
- **機能**：
  - Low/Balanced/High Load モデルへのルーティング
  - モード変更の再評価（定期/手動）

---

## 📌 通信モード層

### ◼ Low Load Model
- **対象**：スマホ・CGNAT・UDP不可環境
- **方式**：HTTP Long Polling / MQTT Relay
- **備考**：匿名性は低いが確実性優先

### ◼ Balanced Model
- **対象**：一般的なPC・安定した家庭回線
- **方式**：UDP Gossip / DHTベース
- **備考**：VoVの標準通信経路

### ◼ High Load Model
- **対象**：グローバルIPv6/固定IP/ポート開放可能
- **方式**：libp2p + NAT Traversal + Relay
- **備考**：最大性能・高冗長性、匿名性強化層へ接続

---

## 📌 VoV VC Layer（Void Creation Layer）

### ◼ NodeID Registry
- **責務**：NodeID（公開鍵ハッシュ）と到達情報の対応管理
- **方式**：分散型Kademlia DHT
- **備考**：TTL管理による動的更新

### ◼ Relay Mesh
- **責務**：NAT越え不能ノードや一時通信を中継
- **構造**：信頼ノードによる多重冗長構成
- **備考**：フォールバックルートにも使用

### ◼ Virtual Addressing
- **責務**：NodeID ⇄ IPアドレスの解決・抽象化
- **方式**：暗号化アドレスバインディング
- **備考**：匿名性担保と物理経路分離を両立

### ◼ Prioritizer
- **責務**：ストレージ貢献量に応じた優先通信制御
- **方式**：送信/中継/格納のQoSレベル制御
- **備考**：スコア評価は公開ログ＋ランダム性で操作困難に

### ◼ Direct Node Channel
- **責務**：PC等の高性能ノード間に常時通信路を構築
- **方式**：ポート開放、libp2pのDirect Connection
- **備考**：匿名的な常時再送・監視・バックアップ経路にもなる

---

## 📌 Distributed Storage

- **責務**：VoV投稿・返信・関連メタデータの断片格納
- **方式**：冗長シャーディング（Erasure Coding）＋NodeID参照管理
- **備考**：復元失敗時はRelay経由や再伝播にフォールバック
